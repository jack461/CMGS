/*
    Hachage du son
    Fréquence par X.par 0
*/

// Idem 33, sauf les valeurs imposée dans la dernière boucle
// On alterne 0, 0 et 1, 1 au lieu de 1, 0 et 0, 1


var s = stralloc();
var k;

var clip = get(`gm, `cellAlt);

sprintf(s, "Hashing - Start - Clip %04d", clip); GM_Log(s);

var w = 0.1; // wait

var stat = get(`gm, `cbStat);

w = get(`pval, `XtndP0)

sprintf(s, "    vars: %d, %f", stat, w); GM_Log(s);

var U = play(`clip, clip, `spmode, 22, `plmode, 0, `unit);
wait(0.1);

while ((k = gmem[U + stat ]) === 3) (
   wait(0.01);
);

wait(0.1);

k = gmem[U + stat];
sprintf(s, "    status = %d", k); GM_Log(s);


// On recupère la valeur du paramètre "XtndP0" à chaque changement de volume.
//  "XtndP0" varie de 0 à 10000. On interprète ceci comme une valeur en ms,
//  et on divise par 1000 pour obtenir une valeur en secondes attendues par "wait"
while ((k = gmem[U + stat ]) === 258) (

    // Volume 1 à gauche et à droite
    call(`player, U, `KmdImm, 4, 1, 1, 2, 0);
    w = get(`pval, `XtndP0) / 1000;
    wait(w);

    // Volume 0 à gauche et à droite
    call(`player, U, `KmdImm, 4, 0, 0, 2, 0);
    w = get(`pval, `XtndP0) / 1000;
    wait(w);
);



GM_Log("Hashing - fin", " ");

strfree(s);
