/*
    Auto pan 
    Fréquence par X.par 0
*/


var s = stralloc();
var k;

var clip = get(`gm, `cellAlt);
sprintf(s, "Test 35 - Start - Clip %04d", clip); GM_Log(s);

var stat = get(`gm, `cbStat);

var w = get(`pval, `XtndP0);

sprintf(s, "    vars: %d, %d, %f", stat, w); GM_Log(s);

var U = play(`clip, clip, `spmode, 22, `plmode, 0, `unit);

sprintf(s, "Unit = %d", U); GM_Log(s);

wait(0.1); // délai obligatoire

while ((k = gmem[U + stat]) === 3) (
   wait(0.01);
);

wait(0.1);
k = gmem[U + stat];
sprintf(s, "    status = %d", k); GM_Log(s);

// Lancement de l'action sur le player. Dans l'ordre:
// `player (mot clef),
//  U (adresse du player),
//  `KmdDly (commande "avec délai"),
//  4 (numéro de la commande)
//  1, 0 (son initial à gauche, rien à droite), 
//  2 (facteur de répétition d'une boucle interne),
//  2 (code de l'action: vrai panoramique)
call(`player, U, `KmdDly, 4, 0, 1, 2, 2);

while ((k = gmem[U + stat]) === 258) (
    wait(1);
);


GM_Log("Test 35 - End", " ");

strfree(s);
