/*
    Gauche/Droite par script
    Fréquence fixe
*/

var s = stralloc();
var k;
var clip = get(`gm, `cellAlt);
sprintf(s, "Test 32 - Start - Clip %04d", clip); GM_Log(s);

var wt = 0.1; // wait 100 ms

var stat = get(`gm, `cbStat);

sprintf(s, "    vars: %d, %d, %04d", stat, clip); GM_Log(s);

var U = play(`clip, clip, `spmode, 22, `plmode, 0, `unit);

sprintf(s, "Unit = %d", U); GM_Log(s);
wait(0.1);

while ((k = gmem[U + stat]) === 3) (
   wait(0.01);
);

wait(0.1);

k = gmem[U + stat];
sprintf(s, "    status = %d", k); GM_Log(s);


// Chaque boucle dure 2 fois "wt", soit 200 ms; la fréquence
// du battement est donc 5 Hz.
while ((k = gmem[U + stat ]) === 258) (

    // 1, 0 = volume 1 à gauche, 0 à droite
    call(`player, U, `KmdImm, 4,  1, 0, 2, 0);
    wait(wt);

    // 0, 1 = volume 0 à gauche, 1 à droite
    call(`player, U, `KmdImm, 4, 0, 1, 2, 0);
    wait(wt);
);



GM_Log("Test 32 - End", " ");

strfree(s);
