
GM_Log("T07-Start: multiple threads testing.");

var str = stralloc();
var sgt = stralloc();

sprintf(str, "THID = %.0f", thread(`idt));

GM_Log(str);

wait(2);

function xyz()
(
    wait(10 + rand(30));
    sprintf(sgt, "THUD-%.0f-start", thread(`idt));
    GM_Log(sgt);

    wait(20 + rand(30));
    sprintf(sgt, "THUD-%.0f-middle", thread(`idt));
    GM_Log(sgt);

    wait(40 + rand(30));
    sprintf(sgt, "THUD-%.0f-middle 2", thread(`idt));
    GM_Log(sgt);

    wait(50 + rand(30));
    sprintf(sgt, "THUD-%.0f-end", thread(`idt));
    GM_Log(sgt);
);

/*
xyz();

var thr = thread(`new, xyz);

sprintf(str, "thr = %d    xyz = %d", thr, xyz);
GM_Log(str);

// Try to run it...
thread(`run, thr);
*/

loop(128,
    wait(0.1);
    thread(`run, thread(`new, xyz));
);

GM_Log("T07-End");
 